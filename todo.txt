Error logging
Adjust datastructures to be thread safe